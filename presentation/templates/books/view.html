{% extends "base.html" %}
{% block title %}Editar Libro{% endblock %}
{% block content %}
<div class="container mt-5">
    <h1>Editar Libro</h1>
    <form method="POST" action="{{ url_for('web_book.edit_book', book_id=book['id_libro']) }}">
        <div class="mb-3">
            <label for="titulo" class="form-label">Título</label>
            <input type="text" class="form-control" id="titulo" name="titulo" value="{{ book['titulo'] }}" required>
        </div>
        <div class="mb-3">
            <label for="autor" class="form-label">Autor</label>
            <input type="text" class="form-control" id="autor" name="autor" value="{{ book['autor'] }}" required>
        </div>
        <div class="mb-3">
            <label for="editorial" class="form-label">Editorial</label>
            <input type="text" class="form-control" id="editorial" name="editorial" value="{{ book['editorial'] }}">
        </div>
        <div class="mb-3">
            <label for="anio" class="form-label">Año</label>
            <input type="number" class="form-control" id="anio" name="anio" value="{{ book['anio'] }}" required>
        </div>
        <div class="mb-3">
            <label for="precio" class="form-label">Precio</label>
            <input type="number" step="0.01" class="form-control" id="precio" name="precio" value="{{ book['precio'] }}" required>
        </div>
        <div class="mb-3">
            <label for="stock" class="form-label">Stock</label>
            <input type="number" class="form-control" id="stock" name="stock" value="{{ book['stock'] }}" required>
        </div>
        <div class="mb-3">
            <label class="form-label">Categorías</label>
            {% if categories %}
                <select class="form-select" name="categorias" multiple aria-label="Seleccionar categorías">
                    {% for cat in categories %}
                        <option value="{{ cat['id_categoria'] }}"
                            {% if cat['id_categoria'] in book['categorias']|map(attribute='id_categoria')|list %}
                                selected
                            {% endif %}
                        >
                            {{ cat['nombre'] }}
                        </option>
                    {% endfor %}
                </select>
            {% else %}
                <span class="text-muted">No hay categorías cargadas</span>
            {% endif %}
        </div>


        <button type="submit" class="btn btn-primary">Guardar cambios</button>
        <a href="{{ url_for('web_book.list_books') }}" class="btn btn-secondary">Cancelar</a>
    </form>
</div>
{% endblock %}
